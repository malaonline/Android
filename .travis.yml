language: android
jdk: oraclejdk8
sudo: false
android:
  components:
  - platform-tools
  - tools
  - build-tools-25.0.2
  - android-25
  - extra-google-google_play_services
  - extra-google-m2repository
  - addon-google_apis-google-21
  - extra-android-m2repository
  - extra-android-support
before_install:
- openssl aes-256-cbc -K $encrypted_614d74e808da_key -iv $encrypted_614d74e808da_iv
  -in id_rsa.enc -out ~\/.ssh/id_rsa -d
- openssl aes-256-cbc -K $encrypted_614d74e808da_key -iv $encrypted_614d74e808da_iv
  -in mini_keystore.enc -out mini_keystore -d
- openssl aes-256-cbc -K $encrypted_566122ccfbf2_key -iv $encrypted_566122ccfbf2_iv
  -in secrets.tar.enc -out secrets.tar -d
- tar xvf secrets.tar
- chmod +x gradlew
- gem install fir-cli
script:
- ./gradlew assembleDevrelease
- ./gradlew assemblePrdrelease
- ./gradlew assembleStagerelease
deploy:
  provider: releases
  api_key:
    secure: $GITHUB_TOKENS
  file:
  - app/build/outputs/apk/app-parent-devrelease.apk
  - app/build/outputs/apk/app-parent-prdrelease.apk
  - app/build/outputs/apk/app-parent-stagerelease.apk
  skip_cleanup: true
  on:
    tags: false
after_deploy:
- fir p app/build/outputs/apk/app-parent-devrelease.apk -T $FIR_TOKENS -c "`git cat-file
  tag $TRAVIS_TAG`"
- fir p app/build/outputs/apk/app-parent-prdrelease.apk -T $FIR_TOKENS -c "`git cat-file
  tag $TRAVIS_TAG`"
- fir p app/build/outputs/apk/app-parent-stagerelease.apk -T $FIR_TOKENS -c "`git
  cat-file tag $TRAVIS_TAG`"
notifications:
  email:
    recipients:
    - yandebo@malalaoshi.com
    on_success: change
    on_failure: always
  slack:
    secure: C+3cVS/ti5y4qUI4gpaIs5xRmKbUZQhY4Fu07mofeG5ld+uGYCf0v73EQYAFA0vqdWwSwlovxMSbEkKI9LyyZyERkyyq9RaJ7vgdKXctCXR9/nomtpAubR9DNvjKtOXkmOPfzqj2iarhV6q0mmQq/Wl0lJBH+psbzQt0v3Kz9bLCP82vbxoQA7WDvWHam0tzwsQ8bfTvzsgo8bppUrWrm+EGTHCSdlQ4GejPwHvCuGFQ3BZq4bf/R5odXfrBgkeYRBhAZV2QEjrqTTMJbWCG6Phk3wzLAG153+fvzh6WF7j5tctgY7/fyMN8WcaqrP1cdH45AQOLZfQ1V03iJOYfKNg5lR5NonTfEnmAGe6axANROFGellNlsd+zOnUD6eEs3iZs3hdBvz4U0W+o72rQDaYvSE5KpJ7Xw2yAx96kwuTCV9RMOcHzzJg4WCNr5GJt3z7/YZ6oFs7qFblm1/oCuL7IhNSsK/EVTWIH2MHevpXD0ORDA+gU9bt+B7eliqLPTC3Nzu9EkgBxxF615lfavmjD7lALuggm/qzGi0sUaaXhne4WDChNUKyO0za/hP5ZpCkR2lN+FgZKLQflSvbdsP/Y0HvPwRK2uA4aQHrHJp+bwcvVrV/8rxYzPLtGZi+wyrc1SzVBQ7JLg5EU98Sd3+9DWduPBWzOaK8CvmgOD20=
