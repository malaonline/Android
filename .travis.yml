language: android
jdk: openjdk8
sudo: false
android:
  components:
  - platform-tools
  - tools
  - build-tools-25.0.2
  - android-25
  - extra-google-google_play_services
  - extra-google-m2repository
  - addon-google_apis-google-21
  - extra-android-m2repository
  - extra-android-support
before_install:
- openssl aes-256-cbc -K $encrypted_614d74e808da_key -iv $encrypted_614d74e808da_iv
  -in secrets.tar.enc -out secrets.tar -d
- rvm install 2.2.5
- tar xvf secrets.tar
- chmod +x gradlew
- gem install fir-cli
script:
- ./gradlew assembleDevrelease
- ./gradlew assemblePrdrelease
- ./gradlew assembleStagerelease
deploy:
  provider: releases
  api_key:
    secure: OoBXOlglPZdCqvWxdaaPs7xq/eV+C9rV9G2TmNJnvMaUP+vpYUXDEvOGcdDfFtoqB6Rgaq0dCNwyU6e9MKs1PkyLC2Wp/raqratVPkg8siVTq9Xx6Nvocs2TVVK/oiI1msVKYHY0spvrtMvEe3XginEJowB/+KpIhnKYFKZYrsr5WL3XFTENucfcAjOIBfa0cbbyHUJAk0yO4mZ1jb+MHJjl8APai/kVuepugoZx8TqCSLY0+bj13VolR/7yT0t4f4NiVp/VAlv8AUCHb3WToogYarijJSzbgpmEs1RLu2JDIHu01V7rm5y+/evw/mc37HtnLqC/otkDSrIu3DkYocW9YE9+oIp278FxhpMLxt63PN2vRXwHLaVLPHITiuMF4XsSNbyGrqBcwh9++60nSV8Vo2BNBcq6EOoiCA3tlzCdY4DyTSOrtNXfvoe+FxGbD2VRapMgQFyYa+pRzE5mtGKITfAx8O3ZM6bat+Qfvtb+UPd2Lrj0P5YRm5xFI5plXLII5nQvo+SbeQwB/s5zJlgwedu2wE7eTRKrkZKUwQv8VrdMOenzpjE3VTYFu2upLMYIy+F/zCWV+HaEOrNI5AgA3jDWDKWzj6jucJQC+bmL0S1L/fvwj7Kqt3CbyD73PoyllKY/FBhMaZvFS8qranfvnCxbtEHW6F/SzsjxiM0=
  file: 'app/build/outputs/apk/app-parent-devrelease.apk'
  on:
    repo: malaonline/Android
after_deploy:
- fir p app/build/outputs/apk/app-parent-devrelease.apk -T $FIR_TOKENS -c "`git cat-file
  tag $TRAVIS_TAG`"
- fir p app/build/outputs/apk/app-parent-prdrelease.apk -T $FIR_TOKENS -c "`git cat-file
  tag $TRAVIS_TAG`"
- fir p app/build/outputs/apk/app-parent-stagerelease.apk -T $FIR_TOKENS -c "`git
  cat-file tag $TRAVIS_TAG`"
notifications:
  email:
    recipients:
    - yandebo@malalaoshi.com
    on_success: change
    on_failure: always
  slack:
    secure: C+3cVS/ti5y4qUI4gpaIs5xRmKbUZQhY4Fu07mofeG5ld+uGYCf0v73EQYAFA0vqdWwSwlovxMSbEkKI9LyyZyERkyyq9RaJ7vgdKXctCXR9/nomtpAubR9DNvjKtOXkmOPfzqj2iarhV6q0mmQq/Wl0lJBH+psbzQt0v3Kz9bLCP82vbxoQA7WDvWHam0tzwsQ8bfTvzsgo8bppUrWrm+EGTHCSdlQ4GejPwHvCuGFQ3BZq4bf/R5odXfrBgkeYRBhAZV2QEjrqTTMJbWCG6Phk3wzLAG153+fvzh6WF7j5tctgY7/fyMN8WcaqrP1cdH45AQOLZfQ1V03iJOYfKNg5lR5NonTfEnmAGe6axANROFGellNlsd+zOnUD6eEs3iZs3hdBvz4U0W+o72rQDaYvSE5KpJ7Xw2yAx96kwuTCV9RMOcHzzJg4WCNr5GJt3z7/YZ6oFs7qFblm1/oCuL7IhNSsK/EVTWIH2MHevpXD0ORDA+gU9bt+B7eliqLPTC3Nzu9EkgBxxF615lfavmjD7lALuggm/qzGi0sUaaXhne4WDChNUKyO0za/hP5ZpCkR2lN+FgZKLQflSvbdsP/Y0HvPwRK2uA4aQHrHJp+bwcvVrV/8rxYzPLtGZi+wyrc1SzVBQ7JLg5EU98Sd3+9DWduPBWzOaK8CvmgOD20=
